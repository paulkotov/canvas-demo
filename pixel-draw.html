<!DOCTYPE html>
<html>

<body>
  <canvas id="canvas"></canvas>
  <script>
    class Pixel {
      constructor(x, y, color, speed, delay, delayHide, step, boundSize) {
        this.x = x;
        this.y = y;

        this.color = color;
        this.speed = rand(0.1, 0.9) * speed;

        this.size = 0;
        this.sizeStep = rand(0, 0.5);
        this.minSize = 0.5;
        this.maxSizeAvailable = boundSize || 2;
        this.maxSize = rand(this.minSize, this.maxSizeAvailable);
        this.sizeDirection = 1;

        this.delay = delay;
        this.delayHide = delayHide;
        this.counter = 0;
        this.counterHide = 0;
        this.counterStep = step;

        this.isHidden = false;
        this.isFlicking = false;
      }

      draw = (ctx) => {
        const centerOffset = this.maxSizeAvailable * 0.5 - this.size * 0.5;

        ctx.fillStyle = this.color;
        ctx.fillRect(
          this.x + centerOffset,
          this.y + centerOffset,
          this.size,
          this.size
        );
      }

      show = () => {
        this.isHidden = false;
        this.counterHide = 0;

        if (this.counter <= this.delay) {
          this.counter += this.counterStep;
          return;
        }

        if (this.size >= this.maxSize) {
          this.isFlicking = true;
        }

        if (this.isFlicking) {
          this.flicking();
        } else {
          this.size += this.sizeStep;
        }
      }

      hide = () => {
        this.counter = 0;

        if (this.counterHide <= this.delayHide) {
          this.counterHide += this.counterStep;
          if (this.isFlicking) {
            this.flicking();
          }
          return;
        }

        this.isFlicking = false;

        if (this.size <= 0) {
          this.size = 0;
          this.isHidden = true;
          return;
        } else {
          this.size -= 0.05;
        }
      }

      flicking = () => {
        if (this.size >= this.maxSize) {
          this.sizeDirection = -1;
        } else if (this.size <= this.minSize) {
          this.sizeDirection = 1;
        }

        this.size += this.sizeDirection * this.speed;
      }
    }
  </script>
  <script>
    window.addEventListener('load', () => {

    });
  </script>
</body>

</html>